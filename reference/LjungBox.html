<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Ljung and Box Portmanteau Test — LjungBox • wpa</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><script src="../extra.js"></script><meta property="og:title" content="Ljung and Box Portmanteau Test — LjungBox"><meta property="og:description" content="The Ljung-Box (1978) modified portmanteau test. In the
multivariate time series, this test statistic is asymptotically equal to
Hosking.
This method and the bottom documentation is taken directly from the
original 'portes' package."><meta property="og:image" content="https://microsoft.github.io/wpa/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wpa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analyst Guide
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../analyst_guide.html">Introduction</a>
    </li>
    <li>
      <a href="../analyst_guide_getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../analyst_guide_data_validation.html">Data Validation</a>
    </li>
    <li>
      <a href="../analyst_guide_summary.html">Summary Functions</a>
    </li>
    <li>
      <a href="../analyst_guide_distribution.html">Distribution Functions</a>
    </li>
    <li>
      <a href="../analyst_guide_trend.html">Trend Functions</a>
    </li>
    <li>
      <a href="../articles/network-analysis.html">Network Functions</a>
    </li>
    <li>
      <a href="../analyst_guide_reports.html">Reports</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../reference/index.html">Functions</a>
    </li>
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
    <li>
      <a href="../faq.html">FAQ</a>
    </li>
  </ul></li>
<li>
  <a href="../playbook_intro.html">Playbook</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Contribute
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../CONTRIBUTING.html">Contributor Guide</a>
    </li>
    <li>
      <a href="../developer_guide.html">Developer Guide</a>
    </li>
    <li>
      <a href="../reporting_security_issues.html">Reporting Security Issues</a>
    </li>
    <li>
      <a href="../package_structure.html">Package Structure</a>
    </li>
    <li>
      <a href="../contributors.html">Contributors</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro-to-wpa.html">Introduction to {wpa}</a>
    </li>
    <li>
      <a href="../articles/text-mining-capabilities.html">Text-mining Meeting Subject lines</a>
    </li>
    <li>
      <a href="../articles/best-practices.html">Best Practices when using wpa</a>
    </li>
    <li>
      <a href="../articles/IV-report.html">Introduction to Information Value</a>
    </li>
    <li>
      <a href="../articles/Change-over-time.html">Identifying changes over time</a>
    </li>
    <li>
      <a href="../articles/profiles-with-rank.html">Identifying noteworthy groups with rank functions</a>
    </li>
    <li>
      <a href="../articles/network-analysis.html">Introduction to Organizational Network Analysis</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/microsoft/wpa/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Ljung and Box Portmanteau Test</h1>
    <small class="dont-index">Source: <a href="https://github.com/microsoft/wpa/blob/HEAD/R/Ljungbox.R" class="external-link"><code>R/Ljungbox.R</code></a></small>
    <div class="hidden name"><code>LjungBox.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Ljung-Box (1978) modified portmanteau test. In the
multivariate time series, this test statistic is asymptotically equal to
<code>Hosking</code>.</p>
<p>This method and the bottom documentation is taken directly from the
original 'portes' package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">LjungBox</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  lags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  order <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  season <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  squared.residuals <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obj</dt>
<dd><p>a univariate or multivariate series with class "numeric",
"matrix", "ts", or ("mts" "ts"). It can be also an object of fitted
time-series model with class "ar", "arima0", "Arima", ("ARIMA forecast
ARIMA Arima"), "lm", ("glm" "lm"), or "varest". obj may also an object with
class "list" (see details and following examples).</p></dd>


<dt>lags</dt>
<dd><p>vector of lag auto-cross correlation coefficients used for
<code>Hosking</code> test.</p></dd>


<dt>order</dt>
<dd><p>Default is zero for testing the randomness of a given sequence
with class "numeric", "matrix", "ts", or ("mts" "ts"). In general order
equals to the number of estimated parameters in the fitted model. If obj is
an object with class "ar", "arima0", "Arima", "varest", ("ARIMA forecast
ARIMA Arima"), or "list" then no need to enter the value of order as it
will be automatically determined. For obj with other classes, the order is
needed for degrees of freedom of asymptotic chi-square distribution.</p></dd>


<dt>season</dt>
<dd><p>seasonal periodicity for testing seasonality. Default is 1 for
testing the non seasonality cases.</p></dd>


<dt>squared.residuals</dt>
<dd><p>if <code>TRUE</code> then apply the test on the squared values.
This checks for Autoregressive Conditional Heteroscedastic, <code>ARCH</code>,
effects. When <code>squared.residuals = FALSE</code>, then apply the test on the usual
residuals.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The Ljung and Box test statistic with the associated p-values for different
lags based on the asymptotic chi-square distribution with <code>k^2(lags-order)</code></p>


<p>degrees of freedom.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>However the portmanteau test statistic can be applied directly on
the output objects from the built in R functions ar(), ar.ols(), ar.burg(),
ar.yw(), ar.mle(), arima(), arim0(), Arima(), auto.arima(), lm(), glm(),
and VAR(), it works with output objects from any fitted model. In this
case, users should write their own function to fit any model they want,
where they may use the built in R functions FitAR(), garch(), garchFit(),
fracdiff(), tar(), etc. The object obj represents the output of this
function. This output must be a list with at least two outcomes: the fitted
residual and the order of the fitted model (list(res = ..., order = ...)).
See the following example with the function FitModel().</p>
<p>Note: In stats R, the function Box.test was built to compute the Box and
Pierce (1970) and Ljung and Box (1978) test statistics only in the
univariate case where we can not use more than one single lag value at a
time. The functions BoxPierce and LjungBox are more accurate than Box.test
function and can be used in the univariate or multivariate time series at
vector of different lag values as well as they can be applied on an output
object from a fitted model described in the description of the function
BoxPierce.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ljung, G.M. and Box, G.E.P (1978). "On a Measure of Lack of Fit in Time
Series Models". Biometrika, 65, 297-303.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Esam Mahdi and A.I. McLeod</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">LjungBox</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># univariate test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lags statistic df   p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5  6.047684  5 0.3016067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    10 10.746921 10 0.3775722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    15 13.570146 15 0.5583478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    20 21.296301 20 0.3798807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    25 23.690044 25 0.5373358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    30 28.477472 30 0.5451503</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">LjungBox</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># multivariate test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lags statistic  df   p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5  12.67671  20 0.8908200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    10  37.63032  40 0.5774456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    15  63.44248  60 0.3560419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    20  89.93882  80 0.2096668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    25 105.05144 100 0.3451988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    30 126.02761 120 0.3351911</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martin Chan, Carlos Morales.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'f45eacc22edb0c386f1f5b9bb89f76be',
    indexName: 'wpa',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

