<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Frequently Asked Questions • wpa</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css"><script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="pkgdown.js"></script><!-- docsearch --><script src="docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><script src="extra.js"></script><meta property="og:title" content="Frequently Asked Questions"><meta property="og:image" content="https://microsoft.github.io/wpa/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-title-body">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">wpa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analyst Guide
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="analyst_guide.html">Introduction</a>
    </li>
    <li>
      <a href="analyst_guide_getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="analyst_guide_data_validation.html">Data Validation</a>
    </li>
    <li>
      <a href="analyst_guide_summary.html">Summary Functions</a>
    </li>
    <li>
      <a href="analyst_guide_distribution.html">Distribution Functions</a>
    </li>
    <li>
      <a href="analyst_guide_trend.html">Trend Functions</a>
    </li>
    <li>
      <a href="articles/network-analysis.html">Network Functions</a>
    </li>
    <li>
      <a href="analyst_guide_reports.html">Reports</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="reference/index.html">Functions</a>
    </li>
    <li>
      <a href="news/index.html">Changelog</a>
    </li>
    <li>
      <a href="faq.html">FAQ</a>
    </li>
  </ul></li>
<li>
  <a href="playbook_intro.html">Playbook</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Contribute
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="CONTRIBUTING.html">Contributor Guide</a>
    </li>
    <li>
      <a href="developer_guide.html">Developer Guide</a>
    </li>
    <li>
      <a href="reporting_security_issues.html">Reporting Security Issues</a>
    </li>
    <li>
      <a href="package_structure.html">Package Structure</a>
    </li>
    <li>
      <a href="contributors.html">Contributors</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="articles/intro-to-wpa.html">Introduction to {wpa}</a>
    </li>
    <li>
      <a href="articles/text-mining-capabilities.html">Text-mining Meeting Subject lines</a>
    </li>
    <li>
      <a href="articles/best-practices.html">Best Practices when using wpa</a>
    </li>
    <li>
      <a href="articles/IV-report.html">Introduction to Information Value</a>
    </li>
    <li>
      <a href="articles/Change-over-time.html">Identifying changes over time</a>
    </li>
    <li>
      <a href="articles/profiles-with-rank.html">Identifying noteworthy groups with rank functions</a>
    </li>
    <li>
      <a href="articles/network-analysis.html">Introduction to Organizational Network Analysis</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/microsoft/wpa/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Frequently Asked Questions</h1>
    </div>


<div id="frequently-asked-questions" class="section level1">
<div class="section level2">
<h2 id="general">General<a class="anchor" aria-label="anchor" href="#general"></a></h2>
<div class="section level3">
<h3 id="why-should-i-use-r-for-workplace-analytics">Why should I use R for Workplace Analytics?<a class="anchor" aria-label="anchor" href="#why-should-i-use-r-for-workplace-analytics"></a></h3>
<p>R is an open-source statistical programming language and one of the most popular toolkits for data analysis and data science. There are four key reasons why a Workplace Analytics analyst might choose to use R instead of other alternatives:</p>
<ol style="list-style-type: decimal"><li>R has an <strong>immense package eco-system</strong> with over <a href="https://cran.r-project.org/web/packages/" class="external-link">17,000 packages</a> for advanced applications from building random forest models to Organizational Network Analysis (ONA) graph visualizations. This enables analysts to perform specialized and more in-depth analysis for specific Workplace Analytics use cases, such as predicting employee churn by analyzing Workplace Analytics metrics.</li>
<li>There are <strong>no licensing costs</strong> with R, which enables analysts to leverage the powerful functionality with no additional cost.<br></li>
<li>R has a code-oriented workflow (as opposed to point-and-click), which promotes <strong>reproducibility</strong>. This is valuable for improving the quality of the analysis and for efficiently replicating analysis with different data samples.</li>
<li>R also has a <strong>substantial user community</strong>, which analysts can access to support and augment their analysis capabilities.</li>
</ol></div>
</div>
<div class="section level2">
<h2 id="installation-and-setup">Installation and Setup<a class="anchor" aria-label="anchor" href="#installation-and-setup"></a></h2>
<div class="section level3">
<h3 id="i-cannot-install-the-package-with-installpackages-why-is-that">I cannot install the package with <code>install.packages()</code>. Why is that?<a class="anchor" aria-label="anchor" href="#i-cannot-install-the-package-with-installpackages-why-is-that"></a></h3>
<p>Since 6th April 2021, <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> should work with <strong>wpa</strong> as it is made available on CRAN on that date. If you continue to experience issues, please create an issue at <a href="https://github.com/microsoft/wpa/issues/" class="external-link uri">https://github.com/microsoft/wpa/issues/</a>, and install with the development version in the mean time:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"microsoft/wpa"</span>, upgrade <span class="op">=</span> <span class="st">"never"</span><span class="op">)</span> </code></pre></div>
<p>If the above does not work, please also try:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://github.com/microsoft/wpa.git"</span>, upgrade <span class="op">=</span> <span class="st">"never"</span><span class="op">)</span></code></pre></div>
<p>For more information regarding installation, please see our <a href="https://microsoft.github.io/wpa/analyst_guide_getting_started.html">Getting Started</a> page.</p>
</div>
<div class="section level3">
<h3 id="i-see-a-warning-message-about-the-installation-of-rtools-what-should-i-do">I see a warning message about the installation of Rtools. What should I do?<a class="anchor" aria-label="anchor" href="#i-see-a-warning-message-about-the-installation-of-rtools-what-should-i-do"></a></h3>
<p>You may see the following message during installation:</p>
<pre><code>WARNING: Rtools is required to build R packages, but is not currently installed.</code></pre>
<p>This message appears when R is trying to install or update packages that require compilation from binaries, which requires the installation of Rtools. To get around this, we recommend selecting <code>No</code> when prompted the question <code>Do you want to install from sources the packages which needs compilation?</code> when updated the packages. Alternatively, you can also choose to install <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a>.</p>
<p>The reason why you may be prompted the <em>install from sources</em> question is because one of the packages that <strong>wpa</strong> is dependent on has updated recently on CRAN, but the binary is not available for your operating system (yet). If you choose <code>No</code>, you will not get the most recent version, which in most cases will not be a problem. If you choose <code>Yes</code>, the package will be built from source locally, and you will need <strong>Rtools</strong> to do that. <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</div>
<div class="section level3">
<h3 id="im-still-having-trouble-installing-the-package-what-can-i-do">I’m still having trouble installing the package. What can I do?<a class="anchor" aria-label="anchor" href="#im-still-having-trouble-installing-the-package-what-can-i-do"></a></h3>
<p>The most common cause for package installation failures is when users try to install the package when some of the dependent packages are loaded. As a best practice, you should always install or update packages in a <em>fresh</em> R Session (no packages loaded and a clear workspace). In RStudio, you can refresh your session with the shortcut <code>Ctrl + Shift + F10</code>. You can try the installation command again in a new R Session.</p>
<p>Make sure you follow the recommend installation steps listed on our <a href="https://microsoft.github.io/wpa/analyst_guide_getting_started.html">Getting Started</a> page. If installation problems persist, please create an issue at <a href="https://github.com/microsoft/wpa/issues/" class="external-link uri">https://github.com/microsoft/wpa/issues/</a> and describe the error message that you see on your console.</p>
</div>
<div class="section level3">
<h3 id="which-version-of-r-should-i-use">Which version of R should I use?<a class="anchor" aria-label="anchor" href="#which-version-of-r-should-i-use"></a></h3>
<p>You are recommended to use the latest stable version of R. You can find the latest version on <a href="https://www.r-project.org/" class="external-link uri">https://www.r-project.org/</a>.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-install-from-a-development--experimental-branch-of-the-package">How do I install from a development / experimental branch of the package?<a class="anchor" aria-label="anchor" href="#how-do-i-install-from-a-development--experimental-branch-of-the-package"></a></h3>
<p>If you wish to install a version of the package from any branch <strong>other than the main branch</strong>, you can run the following code:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_git</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://github.com/microsoft/wpa.git"</span>,
                      branch <span class="op">=</span> <span class="st">"&lt;BRANCH-NAME&gt;"</span>, <span class="co"># Replace</span>
                      build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>You should replace the <code>&lt;BRANCH-NAME&gt;</code> with the name of your target branch, such as <code>"feature/network-functions"</code>.</p>
</div>
<div class="section level3">
<h3 id="should-i-install-r-to-my-onedrive-or-a-cloud-folder">Should I install R to my OneDrive or a cloud folder?<a class="anchor" aria-label="anchor" href="#should-i-install-r-to-my-onedrive-or-a-cloud-folder"></a></h3>
<p>No, you should not. You should never install the default directory for R to OneDrive, as R is a program and you are likely to experience significant cloud syncing issues if you do so. If you use Windows and have experienced this issue, please uninstall and follow the below steps for re-installation:</p>
<ol style="list-style-type: decimal"><li>Install RStudio to the default directory, e.g. <code>C:\Program Files\R\R-4.X.X\library\base\R\Rprofile</code>
</li>
<li>Change the default RStudio package installation location so that it does not save to OneDrive, or another cloud drive. This ensures that OneDrive doesn’t attempt to upload the thousands of files that will be downloaded via the installation of the packages. The R folder where these packages install to is by default created in the Documents folder, which by automatically syncs with OneDrive. We will be moving the installation path to our local <code>C:</code> drive instead to prevent this.</li>
<li>Create a local folder. Open <code>File Explorer</code> -&gt; <code>C:</code> drive -&gt; <code>Create New Folder</code> -&gt; Name it <code>"R"</code>
</li>
<li>Change permissions:<ul><li>If you installed RStudio in the default directory, the path to your RProfile file is <code>C:\Program Files\R\R-4.X.X\library\base\R\Rprofile</code>
</li>
<li>Navigate to <code>C:\Program Files\R\R-4.X.X\library\base\</code>
</li>
<li>Double-click the base folder so that you’re looking at its contents, which include the R subfolder.</li>
<li>Right-click on the R subfolder and select Properties.</li>
<li>Click on the <code>Security</code> tab.</li>
<li>Click on the <code>Edit</code> button.</li>
<li>Scroll down the Group or user names pane and click on the Users line near the bottom of that list.</li>
<li>In the <code>Permissions for users</code> pane, click on the <code>Full Control</code> checkbox under <code>Allow</code>.</li>
<li>Click OK and OK again to save and exit these windows.</li>
</ul></li>
<li>Edit the <code>Rprofile</code> file:<ul><li>Ensure that RStudio is closed.</li>
<li>Navigate to <code>C:\Program Files\R\R-4.X.X\library\base\R\</code>
</li>
<li>Open the <code>Rprofile</code> file with your preferred text editor.</li>
<li>Save a copy of the file in the same directory and name it <code>"RProfileBackup.txt"</code>.</li>
<li>Reopen the <code>Rprofile</code> file with your preferred text editor.</li>
<li>Replace the string <code>Sys.getenv("R_USER")</code> with the string <code>"C:/R"</code><ul><li>Ensure you are replacing the string <code>Sys.getenv("R_USER")</code> and NOT the string <code>Sys.getenv("R_LIBS_USER")</code>
</li>
<li>The string <code>"C:/R"</code> should align with the directory where you created the folder in step 3a</li>
<li>Reference the <code>RProfileBackup.txt</code> as a backup if OneDrive uploads the package files after installation</li>
</ul></li>
<li>Save the file and close out of your text editor and File Explorer.</li>
</ul></li>
</ol><p>You should then be able to install the <strong>wpa</strong> library by opening RStudio and running the following code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Check if remotes is installed, if not then install it</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">"remotes"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"microsoft/wpa"</span>, upgrade <span class="op">=</span> <span class="st">"never"</span><span class="op">)</span></code></pre></div>
<p>You can then restart RStudio with <code>Ctrl</code> + <code>Shift</code> + <code>F10</code> in Windows.</p>
</div>
</div>
<div class="section level2">
<h2 id="import--export">Import / Export<a class="anchor" aria-label="anchor" href="#import--export"></a></h2>
<div class="section level3">
<h3 id="which-workplace-analytics-flexible-queries-can-i-use-with-the-r-package">Which Workplace Analytics flexible queries can I use with the R package?<a class="anchor" aria-label="anchor" href="#which-workplace-analytics-flexible-queries-can-i-use-with-the-r-package"></a></h3>
<p>Currently, you can use the following flexible queries with the R package: - Standard Person Query (includes Ways of Working Assessment Query) - Standard Meeting Query - Hourly Collaboration Query - Group-to-Group Query</p>
<p>You can explore functions in <strong>wpa</strong> with <a href="https://microsoft.github.io/wpa/analyst_guide_getting_started.html#demo-data">demo datasets</a>.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-export-the-outputs-of-my-analysis-to-excel">How do I export the outputs of my analysis to Excel?<a class="anchor" aria-label="anchor" href="#how-do-i-export-the-outputs-of-my-analysis-to-excel"></a></h3>
<p>The <code><a href="reference/export.html">export()</a></code> function allows you to export the outputs of your analysis to Excel in two ways.<br>
1. By setting <code>method</code> to <code>"clipboard"</code> and passing a data frame through to <code><a href="reference/export.html">export()</a></code> , the results will be copied to your clipboard and you can paste it through to Excel. 2. By setting <code>method</code> to <code>"csv"</code>, a CSV file will be saved in the specified path relative to your current working directory. The CSV file can then be opened in Excel.</p>
<p>If you would like to export a <em>list</em> of data frames to Excel where (i) each data frame in the list corresponds to a <em>Worksheet</em> and (ii) the name of each list member corresponds to the <em>Sheet name</em>, you can use <code>writexl::write_xlsx()</code>. <strong>wpa</strong> does not depend on functions from <strong>writexl</strong>, so you may need to load and install it separately.</p>
</div>
</div>
<div class="section level2">
<h2 id="analysis-and-visualization">Analysis and Visualization<a class="anchor" aria-label="anchor" href="#analysis-and-visualization"></a></h2>
<div class="section level3">
<h3 id="how-do-i-filter-by-specific-date-ranges">How do I filter by specific date ranges?<a class="anchor" aria-label="anchor" href="#how-do-i-filter-by-specific-date-ranges"></a></h3>
<p>We recommend using <strong>dplyr</strong> (which is loaded in as part of <strong>tidyverse</strong>) for data manipulation. To filter down to a specific date range in a Person Query, you can run:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microsoft/wpa/" class="external-link">wpa</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> <span class="co"># Or load dplyr</span>

<span class="co"># Read Standard Person Query from local directory</span>
<span class="co"># Assign it to `raw_spq`</span>
<span class="va">raw_spq</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/import_wpa.html">import_wpa</a></span><span class="op">(</span><span class="st">"data/standard person query.csv"</span><span class="op">)</span>

<span class="co"># Assign filtered data frame to `clean_spq`</span>
<span class="va">clean_spq</span> <span class="op">&lt;-</span>
    <span class="va">raw_spq</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"08/30/2020"</span>, <span class="st">"%m/%d/%Y"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"12/19/2020"</span>, <span class="st">"%m/%d/%Y"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The above example filters the date range from the week commencing 30th of August 2020 to the week ending 19th of November 2020 inclusive. Note that the first date is a Sunday (beginning of the week) and the second date is a Saturday (end of the week). If you query is run by <strong>day</strong>, you should specify the <em>after</em> filter as the exact last day, rather than the Saturday of the week.</p>
<p>In some scenarios, you may also want to exclude a particular week from the data. You can use a similar approach:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clean_spq2</span> <span class="op">&lt;-</span>
    <span class="va">clean_spq</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"11/22/2020"</span>, <span class="st">"%m/%d/%Y"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The above line of code excludes the week of 22nd of November 2020, using the operator <code>!=</code> to denote <em>not equal to</em>. Conversely, you can isolate that single week by replacing <code>!=</code> with <code>==</code>.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-create-a-custom-hr-variable">How do I create a custom HR variable?<a class="anchor" aria-label="anchor" href="#how-do-i-create-a-custom-hr-variable"></a></h3>
<p>The most common way to create a ‘custom HR variable’ is to create a categorical variable from one or more numeric variables. You may want to do this if you are trying to <em>bin</em> a numeric variable or create a custom rule-based segmentation with Workplace Analytics metrics.</p>
<p>Here is an example of how to create a categorical variable (<code>N_DirectReports_NET</code>) with a numeric variable representing the number of direct reports, using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code> .</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microsoft/wpa/" class="external-link">wpa</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> <span class="co"># Or load dplyr</span>

<span class="va">clean_spq_with_new_var</span> <span class="op">&lt;-</span>
  <span class="va">clean_spq</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="co"># Standard Person Query</span>
  <span class="fu">mutate</span><span class="op">(</span>N_DirectReports_NET <span class="op">=</span>
         <span class="fu">case_when</span><span class="op">(</span><span class="va">NumberofDirectReports</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"0"</span>,
                   <span class="va">NumberofDirectReports</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"1"</span>,
                   <span class="va">NumberofDirectReports</span> <span class="op">&lt;=</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"2 to 5"</span>,
                   <span class="va">NumberofDirectReports</span> <span class="op">&lt;=</span> <span class="fl">10</span> <span class="op">~</span> <span class="st">"6 to 10"</span>,
                   <span class="va">NumberofDirectReports</span> <span class="op">&lt;=</span> <span class="fl">20</span> <span class="op">~</span> <span class="st">"Up to 20"</span>,
                   <span class="va">NumberofDirectReports</span> <span class="op">&gt;=</span> <span class="fl">21</span> <span class="op">~</span> <span class="st">"21 +"</span>,
                   <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Not classified"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> creates a new column, whereas <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code> runs an if-else operation to classify numeric ranges to the right hand side of the <code>~</code> symbol. When the expression on the left hand side evaluates to <code>TRUE</code>, the value on the right hand side is assigned to the new column. At the end of the code, you will see that anything that doesn’t get classified gets an ‘error handling’ value. If a value ends up as “Not classified”, you should check whether there may be gaps in your <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code> chunk that is not capturing all the values.</p>
<p>Once you have created this new variable and checked that the classifications are correct, you can further your analysis by using it as an HR attribute, such as:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clean_spq_with_new_var</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="reference/keymetrics_scan.html">keymetrics_scan</a></span><span class="op">(</span>hrvar <span class="op">=</span> <span class="st">"N_DirectReports_NET"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-do-i-customize-a-visual-generated-from-a-wpa-function">How do I customize a visual generated from a {wpa} function?<a class="anchor" aria-label="anchor" href="#how-do-i-customize-a-visual-generated-from-a-wpa-function"></a></h3>
<p>With a few exceptions, most plot outputs returned from <strong>wpa</strong> functions are <code>ggplot</code> objects. What this means is that you can edit or add layers to the outputs. See <a href="https://microsoft.github.io/wpa/articles/intro-to-wpa.html#customizing-plot-outputs">here</a> for an example of how you can make customizations.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-create-a-bar-chart-with-a-custom-metric">How do I create a bar chart with a custom metric?<a class="anchor" aria-label="anchor" href="#how-do-i-create-a-bar-chart-with-a-custom-metric"></a></h3>
<p>Sometimes you may wish to create an equivalent bar chart of <code><a href="reference/email_summary.html">email_sum()</a></code>, but for a custom metric or another Workplace Analytics metric that does not form part of the <code>*_sum()</code> family. This is where <strong>flexible functions</strong> are helpful, where you can use <code><a href="reference/create_bar.html">create_bar()</a></code> to produce the same visualization by supplying the custom metric name to the <code>metric</code> argument. For instance, a bar chart for <code>"Generate_workload_email_hours"</code> could be run with:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/create_bar.html">create_bar</a></span><span class="op">(</span><span class="va">sq_data</span>, metric <span class="op">=</span> <span class="st">"Generate_workload_email_hours"</span><span class="op">)</span></code></pre></div>
<p>The same person-average computation is used and the same minimum group threshold argument is also available with <code><a href="reference/create_bar.html">create_bar()</a></code>. The same is equivalent for the other visualizations:</p>
<ul><li>
<code><a href="reference/email_line.html">email_line()</a></code> –&gt; <code><a href="reference/create_line.html">create_line()</a></code>
</li>
<li>
<code><a href="reference/email_trend.html">email_trend()</a></code> –&gt; <code><a href="reference/create_trend.html">create_trend()</a></code>
</li>
<li>
<code><a href="reference/email_dist.html">email_dist()</a></code> –&gt; <code><a href="reference/create_dist.html">create_dist()</a></code>
</li>
<li>
<code><a href="reference/email_fizz.html">email_fizz()</a></code> –&gt; <code><a href="reference/create_fizz.html">create_fizz()</a></code>
</li>
<li>
<code><a href="reference/email_rank.html">email_rank()</a></code> –&gt; <code><a href="reference/create_rank.html">create_rank()</a></code>
</li>
</ul><p>Some functions also act as wrappers around <strong>ggplot2</strong> code where the data is directly plotted without additional person average computation. Examples include <code><a href="reference/create_bar_asis.html">create_bar_asis()</a></code> and <code><a href="reference/create_line_asis.html">create_line_asis()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="im-looking-for-analysis-inspirations-any-ideas">I’m looking for analysis inspirations. Any ideas?<a class="anchor" aria-label="anchor" href="#im-looking-for-analysis-inspirations-any-ideas"></a></h3>
<p>For analysis inspirations, we recommend having a look through our <a href="https://microsoft.github.io/wpa/playbook_intro.html">R playbook</a> identifying useful analyses or functions for exploring a particular area of Workplace Analytics.</p>
<p>If you have an idea for an analysis and would like this to be documented in the Playbook, you are very welcome to create an issue at <a href="https://github.com/microsoft/wpa/issues/" class="external-link uri">https://github.com/microsoft/wpa/issues/</a> where we can add your idea and we will credit you as a contributor. You can also use the issue to invite discussion on your analysis idea, although we ask to please keep the discussion relevant to analysis via the R package.</p>
</div>
<div class="section level3">
<h3 id="how-do-i-reorder-hr-attributes-when-creating-a-plot-in-the-package">How do I reorder HR attributes when creating a plot in the package?<a class="anchor" aria-label="anchor" href="#how-do-i-reorder-hr-attributes-when-creating-a-plot-in-the-package"></a></h3>
<p>Some functions, such as <code><a href="reference/create_bar.html">create_bar()</a></code> , offer an argument (<code>rank</code>) for ordering the categorical variable, i.e. the HR attribute when creating the visualisation. Other functions by default perform no ordering, so they show up in the same order as the data is presented.</p>
<p>For instance, the following code would yield a stacked bar plot with no ordering applied:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microsoft/wpa/" class="external-link">wpa</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>

<span class="co">#### NO REORDERING ####</span>
<span class="va">sq_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="reference/create_dist.html">create_dist</a></span><span class="op">(</span>hrvar <span class="op">=</span> <span class="st">"LevelDesignation"</span>,
              metric <span class="op">=</span> <span class="st">"Email_hours"</span><span class="op">)</span></code></pre></div>
<p>To apply an ordering manually, the best way is to convert the HR attribute into a <strong>factor</strong> variable, where you can specify the <em>levels</em>. You can understand <em>levels</em> as a way to specify the order in which the values of your HR attribute should be ranked. The following code will yield an ordered stacked bar plot:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#### ORDERING APPLIED ####</span>
<span class="va">ld_order</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="co"># Order levels</span>
    <span class="st">"Executive"</span>,
    <span class="st">"Director"</span>,
    <span class="st">"Manager"</span>,
    <span class="st">"Senior IC"</span>,
    <span class="st">"Junior IC"</span>,
    <span class="st">"Support"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Reverse if necessary</span>


<span class="va">sq_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>LevelDesignation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>
    <span class="va">LevelDesignation</span>, 
    levels <span class="op">=</span> <span class="va">ld_order</span> <span class="co"># Specify order</span>
  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="reference/create_dist.html">create_dist</a></span><span class="op">(</span>hrvar <span class="op">=</span> <span class="st">"LevelDesignation"</span>,
              metric <span class="op">=</span> <span class="st">"Email_hours"</span><span class="op">)</span></code></pre></div>
<p>Note that the <code>levels</code> argument within <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> accepts a character vector which matches the values in your HR attribute.</p>
</div>
<div class="section level3">
<h3 id="can-i-use-visuals-from-the-package-within-power-bi">Can I use visuals from the package within Power BI?<a class="anchor" aria-label="anchor" href="#can-i-use-visuals-from-the-package-within-power-bi"></a></h3>
<p><em>Note: this is not a Power BI documentation and therefore will not contain the most recent information on Power BI’s capabilities. This information is accurate to the extent of the author’s knowledge at the time of writing.</em></p>
<p>To use visuals from the <strong>wpa</strong> R library within Power BI, there are two pre-requisites beyond having R and the package installed:</p>
<ul><li>R home directories set. Follow the steps described in <a href="https://docs.microsoft.com/en-us/power-bi/create-reports/desktop-r-visuals#enable-r-visuals-in-power-bi-desktop" class="external-link">Create Power BI visuals using R - Power BI</a>.</li>
<li>Query data imported to Power BI</li>
</ul><p>Only visuals generated from the package of the <code>ggplot</code> object type can be embedded within Power BI. In most cases, what this means is that the visual will only display if the value passed to the <code>return</code> argument in your function is <code>"plot"</code>. For instance, the following is code returns a valid object:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sq_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/email_dist.html">email_dist</a></span><span class="op">(</span>return <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span></code></pre></div>
<p>Note that there are some exceptions to the <code>"plot"</code> rule, as some functions return a HTML widget, such as <code><a href="reference/create_sankey.html">create_sankey()</a></code>. You will also not be able to return data frames, HTML reports, or DataTables objects (the output of <code><a href="reference/create_dt.html">create_dt()</a></code>).</p>
<p>The documentation <a href="https://docs.microsoft.com/en-us/power-bi/create-reports/desktop-r-visuals#enable-r-visuals-in-power-bi-desktop" class="external-link">here</a> provides more details on the limitations of the R visuals.</p>
<p>Here are a series of steps, slightly abridged, taken from the Power BI documentation, last updated July 6th 2021:</p>
<ol style="list-style-type: decimal"><li>Select the R Visual icon in the Visualization pane to add an R visual.</li>
<li>In the<code>Enable script visuals</code> window that appears, select <code>Enable</code>.</li>
<li>In the <code>Values</code> section of the <code>Visualization</code> pane, drag fields from the <code>Fields</code> pane that you want to consume in your R script, just as you would with any other Power BI Desktop visual.<ul><li>Alternatively, you can also select the fields directly in the <code>Fields</code> pane.</li>
<li>Only fields that you’ve added to the <code>Values</code> section are available to your R script.</li>
<li>You can add new fields or remove unneeded fields from the <code>Values</code> section while working on your R script in the R script editor. Power BI Desktop automatically detects which fields you’ve added or removed.</li>
<li>The generated dataframe is named <code>dataset</code>, and you access selected columns by their respective names.</li>
<li>Make sure to use OrderDate instead of Date Hierarchy.</li>
<li>Ensure that you have <code>PersonId</code>, <code>Date</code>, any relevant metrics, and HR attributes included as required as inputs to the R function.</li>
</ul></li>
<li>In the R script editor, below the line <code>"# Paste or type your script code here:,"</code> paste or type: <code><a href="https://github.com/microsoft/wpa/" class="external-link">library(wpa)</a></code>
</li>
<li>Continue pasting or typing the scripts CAUTION: You can run functions in PBI R visual only when the output is visual <code>= "plot"</code>. Otherwise, there will be an error in the R visual placeholder on the report canvas when you run the script.</li>
<li>Run the script by clicking <code>Run script</code> icon in the script editor.</li>
<li>When you modify the script or change the visual area size, you can refresh the visual by clicking Run script icon.</li>
<li>You may apply filters just like other Power BI visuals using Filter pane.</li>
</ol><p>A minimal example that you could try on your R script editor is:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microsoft/wpa/" class="external-link">wpa</a></span><span class="op">)</span>
<span class="va">dataset</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/email_summary.html">email_sum</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="contributing-and-engaging">Contributing and Engaging<a class="anchor" aria-label="anchor" href="#contributing-and-engaging"></a></h2>
<div class="section level3">
<h3 id="how-do-i-find-help-if-i-have-questions-about-using-the-package">How do I find help if I have questions about using the package?<a class="anchor" aria-label="anchor" href="#how-do-i-find-help-if-i-have-questions-about-using-the-package"></a></h3>
<p>You can create an issue at <a href="https://github.com/microsoft/wpa/issues/" class="external-link uri">https://github.com/microsoft/wpa/issues/</a> if you have questions about using the R package. There are no silly questions: chances are that other users have the same question as you, and creating an issue helps us make the package documentation more user-friendly and help other users such as yourself.</p>
</div>
<div class="section level3">
<h3 id="uh-oh-ive-noticed-a-bug-with-the-package-how-do-i-report-this">Uh-oh, I’ve noticed a bug with the package. How do I report this?<a class="anchor" aria-label="anchor" href="#uh-oh-ive-noticed-a-bug-with-the-package-how-do-i-report-this"></a></h3>
<p>You can create a bug report at <a href="https://github.com/microsoft/wpa/issues/" class="external-link uri">https://github.com/microsoft/wpa/issues/</a> if you think you have found a bug with our package. We really appreciate user feedback and we will credit all contributions on our package website.</p>
</div>
<div class="section level3">
<h3 id="i-have-some-ideas-regarding-a-new-feature-for-the-r-package-how-can-i-get-involved">I have some ideas regarding a new feature for the R package. How can I get involved?<a class="anchor" aria-label="anchor" href="#i-have-some-ideas-regarding-a-new-feature-for-the-r-package-how-can-i-get-involved"></a></h3>
<p>If you have an idea in which you would like to collaborate, you can create an issue at <a href="https://github.com/microsoft/wpa/issues/" class="external-link uri">https://github.com/microsoft/wpa/issues/</a>. If there is code that is ready to be reviewed, you can also fork our repository and create a pull request. We’d like to ask you to read our <a href="https://microsoft.github.io/wpa/CONTRIBUTING.html">Contributor Guide</a> and <a href="https://microsoft.github.io/wpa/developer_guide.html">Developer Guide</a> prior to contributing. We will credit your contributions accordingly when your contribution is successfully merged with the package.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr><ol><li id="fn1"><p>This answer references Jenny Bryan’s original response <a href="https://community.rstudio.com/t/meaning-of-common-message-when-install-a-package-there-are-binary-versions-available-but-the-source-versions-are-later/2431/2" class="external-link">here</a> on RStudio Community.<a href="#fnref1" class="footnote-back">↩︎</a></p></li></ol></div>


  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Martin Chan, Carlos Morales.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'f45eacc22edb0c386f1f5b9bb89f76be',
    indexName: 'wpa',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

